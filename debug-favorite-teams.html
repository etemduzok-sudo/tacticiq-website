<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Favori TakÄ±mlar Debug</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 50px auto;
      padding: 20px;
      background: #0F172A;
      color: #fff;
    }
    .section {
      background: #1E293B;
      padding: 20px;
      border-radius: 12px;
      margin-bottom: 20px;
    }
    h1 {
      color: #059669;
    }
    h2 {
      color: #F59E0B;
      margin-top: 0;
    }
    button {
      background: #059669;
      color: white;
      border: none;
      padding: 12px 24px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 16px;
      margin: 5px;
    }
    button:hover {
      background: #047857;
    }
    button.secondary {
      background: #3B82F6;
    }
    button.secondary:hover {
      background: #2563EB;
    }
    pre {
      background: #0F172A;
      padding: 15px;
      border-radius: 8px;
      overflow-x: auto;
      border: 1px solid #334155;
    }
    .team-card {
      background: #334155;
      padding: 15px;
      border-radius: 8px;
      margin: 10px 0;
      display: flex;
      align-items: center;
      gap: 15px;
    }
    .team-logo {
      width: 50px;
      height: 50px;
      object-fit: contain;
    }
    .team-info {
      flex: 1;
    }
    .team-name {
      font-size: 18px;
      font-weight: bold;
      color: #fff;
    }
    .team-id {
      font-size: 14px;
      color: #9CA3AF;
    }
    .status {
      padding: 8px 16px;
      border-radius: 6px;
      font-weight: bold;
      display: inline-block;
      margin: 10px 0;
    }
    .status.success {
      background: #059669;
    }
    .status.error {
      background: #EF4444;
    }
    .status.warning {
      background: #F59E0B;
    }
  </style>
</head>
<body>
  <h1>ğŸ” Favori TakÄ±mlar Debug</h1>

  <div class="section">
    <h2>1ï¸âƒ£ Mevcut Favori TakÄ±mlar</h2>
    <button onclick="checkFavoriteTeams()">Favori TakÄ±mlarÄ± Kontrol Et</button>
    <div id="favoriteTeamsResult"></div>
  </div>

  <div class="section">
    <h2>2ï¸âƒ£ FenerbahÃ§e Ekle</h2>
    <button onclick="addFenerbahce()">FenerbahÃ§e'yi Favori Olarak Ekle</button>
    <div id="addResult"></div>
  </div>

  <div class="section">
    <h2>3ï¸âƒ£ Galatasaray Ekle</h2>
    <button onclick="addGalatasaray()">Galatasaray'Ä± Favori Olarak Ekle</button>
    <div id="addGsResult"></div>
  </div>

  <div class="section">
    <h2>4ï¸âƒ£ Backend Test</h2>
    <button class="secondary" onclick="testBackend()">Backend'i Test Et</button>
    <button class="secondary" onclick="fetchFenerbahceMatches()">FenerbahÃ§e MaÃ§larÄ±nÄ± Ã‡ek</button>
    <div id="backendResult"></div>
  </div>

  <div class="section">
    <h2>5ï¸âƒ£ Temizle</h2>
    <button style="background: #EF4444;" onclick="clearFavorites()">TÃ¼m Favori TakÄ±mlarÄ± Sil</button>
  </div>

  <script>
    const STORAGE_KEY = 'fan-manager-favorite-clubs';
    const BACKEND_URL = 'http://localhost:3000';

    // FenerbahÃ§e bilgileri (API-Football ID: 548)
    const FENERBAHCE = {
      id: 548,
      name: 'Fenerbahce',
      logo: 'https://media.api-sports.io/football/teams/548.png',
      league: 'SÃ¼per Lig'
    };

    // Galatasaray bilgileri (API-Football ID: 645)
    const GALATASARAY = {
      id: 645,
      name: 'Galatasaray',
      logo: 'https://media.api-sports.io/football/teams/645.png',
      league: 'SÃ¼per Lig'
    };

    function checkFavoriteTeams() {
      const result = document.getElementById('favoriteTeamsResult');
      const stored = localStorage.getItem(STORAGE_KEY);
      
      if (!stored) {
        result.innerHTML = '<div class="status warning">âš ï¸ HenÃ¼z favori takÄ±m yok</div>';
        return;
      }

      try {
        const teams = JSON.parse(stored);
        
        if (teams.length === 0) {
          result.innerHTML = '<div class="status warning">âš ï¸ Favori takÄ±m listesi boÅŸ</div>';
          return;
        }

        let html = `<div class="status success">âœ… ${teams.length} favori takÄ±m bulundu</div>`;
        
        teams.forEach(team => {
          html += `
            <div class="team-card">
              <img src="${team.logo}" alt="${team.name}" class="team-logo" onerror="this.src='https://via.placeholder.com/50'">
              <div class="team-info">
                <div class="team-name">${team.name}</div>
                <div class="team-id">ID: ${team.id}</div>
              </div>
            </div>
          `;
        });

        result.innerHTML = html;
      } catch (error) {
        result.innerHTML = `<div class="status error">âŒ Hata: ${error.message}</div>`;
      }
    }

    function addFenerbahce() {
      const result = document.getElementById('addResult');
      
      try {
        const stored = localStorage.getItem(STORAGE_KEY);
        let teams = stored ? JSON.parse(stored) : [];
        
        // Zaten var mÄ± kontrol et
        const exists = teams.some(t => t.id === FENERBAHCE.id);
        if (exists) {
          result.innerHTML = '<div class="status warning">âš ï¸ FenerbahÃ§e zaten favori takÄ±mlar arasÄ±nda</div>';
          return;
        }

        teams.push(FENERBAHCE);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(teams));
        
        result.innerHTML = `
          <div class="status success">âœ… FenerbahÃ§e eklendi!</div>
          <div class="team-card">
            <img src="${FENERBAHCE.logo}" alt="${FENERBAHCE.name}" class="team-logo">
            <div class="team-info">
              <div class="team-name">${FENERBAHCE.name}</div>
              <div class="team-id">ID: ${FENERBAHCE.id}</div>
            </div>
          </div>
          <p style="color: #F59E0B;">âš ï¸ SayfayÄ± yenileyin (F5) deÄŸiÅŸiklikleri gÃ¶rmek iÃ§in!</p>
        `;
      } catch (error) {
        result.innerHTML = `<div class="status error">âŒ Hata: ${error.message}</div>`;
      }
    }

    function addGalatasaray() {
      const result = document.getElementById('addGsResult');
      
      try {
        const stored = localStorage.getItem(STORAGE_KEY);
        let teams = stored ? JSON.parse(stored) : [];
        
        const exists = teams.some(t => t.id === GALATASARAY.id);
        if (exists) {
          result.innerHTML = '<div class="status warning">âš ï¸ Galatasaray zaten favori takÄ±mlar arasÄ±nda</div>';
          return;
        }

        teams.push(GALATASARAY);
        localStorage.setItem(STORAGE_KEY, JSON.stringify(teams));
        
        result.innerHTML = `
          <div class="status success">âœ… Galatasaray eklendi!</div>
          <div class="team-card">
            <img src="${GALATASARAY.logo}" alt="${GALATASARAY.name}" class="team-logo">
            <div class="team-info">
              <div class="team-name">${GALATASARAY.name}</div>
              <div class="team-id">ID: ${GALATASARAY.id}</div>
            </div>
          </div>
          <p style="color: #F59E0B;">âš ï¸ SayfayÄ± yenileyin (F5) deÄŸiÅŸiklikleri gÃ¶rmek iÃ§in!</p>
        `;
      } catch (error) {
        result.innerHTML = `<div class="status error">âŒ Hata: ${error.message}</div>`;
      }
    }

    async function testBackend() {
      const result = document.getElementById('backendResult');
      result.innerHTML = '<div class="status">â³ Backend test ediliyor...</div>';
      
      try {
        const response = await fetch(`${BACKEND_URL}/api/health`);
        const data = await response.json();
        
        result.innerHTML = `
          <div class="status success">âœ… Backend Ã§alÄ±ÅŸÄ±yor!</div>
          <pre>${JSON.stringify(data, null, 2)}</pre>
        `;
      } catch (error) {
        result.innerHTML = `
          <div class="status error">âŒ Backend'e baÄŸlanÄ±lamadÄ±</div>
          <p>Hata: ${error.message}</p>
          <p>Backend'in Ã§alÄ±ÅŸtÄ±ÄŸÄ±ndan emin olun: <code>cd backend && npm start</code></p>
        `;
      }
    }

    async function fetchFenerbahceMatches() {
      const result = document.getElementById('backendResult');
      result.innerHTML = '<div class="status">â³ FenerbahÃ§e maÃ§larÄ± Ã§ekiliyor...</div>';
      
      try {
        const response = await fetch(`${BACKEND_URL}/api/matches/team/548/season/2026`);
        const data = await response.json();
        
        if (data.success && data.data) {
          const matches = data.data;
          const upcomingMatches = matches.filter(m => {
            const status = m.fixture?.status?.short || m.status;
            return status === 'NS' || status === 'TBD';
          });
          
          result.innerHTML = `
            <div class="status success">âœ… FenerbahÃ§e maÃ§larÄ± Ã§ekildi!</div>
            <p><strong>Toplam maÃ§:</strong> ${matches.length}</p>
            <p><strong>YaklaÅŸan maÃ§:</strong> ${upcomingMatches.length}</p>
            <p><strong>Kaynak:</strong> ${data.source}</p>
            <details>
              <summary>Ä°lk 5 yaklaÅŸan maÃ§</summary>
              <pre>${JSON.stringify(upcomingMatches.slice(0, 5), null, 2)}</pre>
            </details>
          `;
        } else {
          result.innerHTML = `<div class="status error">âŒ MaÃ§ bulunamadÄ±</div>`;
        }
      } catch (error) {
        result.innerHTML = `
          <div class="status error">âŒ Hata: ${error.message}</div>
        `;
      }
    }

    function clearFavorites() {
      if (confirm('TÃ¼m favori takÄ±mlarÄ± silmek istediÄŸinizden emin misiniz?')) {
        localStorage.removeItem(STORAGE_KEY);
        alert('âœ… TÃ¼m favori takÄ±mlar silindi!');
        location.reload();
      }
    }

    // Sayfa yÃ¼klendiÄŸinde otomatik kontrol
    window.onload = () => {
      checkFavoriteTeams();
    };
  </script>
</body>
</html>
